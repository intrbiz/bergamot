<!DOCTYPE balsa SYSTEM "http://balsa.intrbiz.net/balsa.dtd">
<?RenderLibrary com.intrbiz.balsa?>
<!-- The index view -->
<fragment xmlns="com.intrbiz.balsa" title="Location - #{location.displayName}">
	<div class="row">
		<data-set var="location" value="#{locations}">
			<a href="/location/name/#{location.name}">
				<div class="col3 dash_icon">
				    <h3>
						<span class="dash_img #{location.state.status.toString().toLowerCase()}" title="The location is #{location.state.status.toString().toLowerCase()}">
							<img src="/applications-internet.png" />
						</span>
						<span class="name">#{location.displayName}</span>
				    </h3>
			    	<p>
					    <span class="label">OK: </span>
					    <span class="value">#{location.state.okCount}</span>
				    </p>
				    <p>
					    <span class="label">Warning: </span>
					    <span class="value">#{location.state.warningCount}</span>
				    </p>
				    <p>
					    <span class="label">Critical: </span>
					    <span class="value">#{location.state.criticalCount}</span>
				    </p>
				</div>
			</a>
		</data-set>
	</div>
	
	<div class="row">
		<data-set var="host" value="#{hosts}">
			<a href="/host/name/#{host.name}">
				<div class="col3 dash_icon">
				    <h3>
						<span class="dash_img #{host.state.status.toString().toLowerCase()}" title="The host is #{host.state.status.toString().toLowerCase()}">
							<img src="/network-server.png" />
						</span>
						<span class="name">#{host.displayName}</span>
				    </h3>
				    <p>
				    	<span class="label">Host name: </span>
				   		<span class="value">#{host.name}</span>
			    	</p>
			    	<p>
				    	<span class="label">Address: </span>
				   		<span class="value">#{host.address}</span>
			    	</p>
			    	<p>
					    <span class="label">Attempt: </span>
					    <span class="value">
					    	<span>#{host.state.attempt} of #{host.currentAttemptThreshold}</span>
					    	<span class="info" rendered="#{host.state.transitioning}" title="The host is changing state">Changing</span>
					    	<span class="info" rendered="#{host.state.hard}" title="The host is in a steady state">Steady</span>
					    </span>
				    </p>
			    	<p>
				    	<span class="label">Last checked: </span>
				   		<span class="value">#{dateformat('HH:mm:ss', host.state.lastCheckTime)} on #{dateformat('EEEE dd/MM/yyyy', host.state.lastCheckTime)}</span>
			    	</p>
			    	<p class="output">
				    	<span class="label">Output: </span>
				    	<span class="value">#{coalesce(host.state.output, '')}</span>
			    	</p>
				</div>
			</a>
		</data-set>
	</div>
	<script type="text/javascript">
		$(document).ready(function(){
			setTimeout(function(){
				window.location = window.location;
			}, 30000);
		});
	</script>
</fragment>