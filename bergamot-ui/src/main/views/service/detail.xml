<!DOCTYPE balsa SYSTEM "http://balsa.intrbiz.net/balsa.dtd">
<?RenderLibrary com.intrbiz.balsa?>
<!-- The index view -->
<fragment xmlns="com.intrbiz.balsa" title="Service #{service.displayName} on Host #{service.host.displayName}">

	<div class="row submenu pull-right">
		<a href="/service/unsuppress/#{service.id}">Unsupress</a>
		<a href="/service/suppress/#{service.id}">Supress</a>
		<a href="/service/disable/#{service.id}">Disable</a>
		<a href="/service/enable/#{service.id}">Enable</a>
		<a href="/service/execute/#{service.id}">Check now</a>
	</div>

	<div class="row">
		<div class="col3 dash_icon">
			<h3>
				<span class="dash_img #{service.state.status.toString().toLowerCase()}" title="The service is #{service.state.status.toString().toLowerCase()}">
					<img src="/applications-system.png" />
				</span>
				<span class="name">#{service.displayName}</span>
		    </h3>
		    <p>
			    <span class="label">Status: </span>
			    <span class="value">#{service.state.status.toString().substring(0,1) + service.state.status.toString().substring(1).toLowerCase()}</span>
		    </p>
		    <p>
			    <span class="label">Attempt: </span>
			    <span class="value">
			    	<span>#{service.state.attempt} of #{service.currentAttemptThreshold}</span>
			    	<span class="info" rendered="#{service.state.transitioning}" title="The service is changing state">Changing</span>
			    	<span class="info" rendered="#{service.state.hard}" title="The service is in a steady state">Steady</span>
			    </span>
		    </p>
		    <p>
			    <span class="label">Suppressed: </span>
			    <span class="value">#{if(service.suppressed, 'yes', 'no')}</span>
		    </p>
		    <p>
			    <span class="label">Enabled: </span>
			    <span class="value">#{if(service.enabled, 'yes', 'no')}</span>
		    </p>
		    <p>
			    <span class="label">Host: </span>
			    <a href="/host/name/#{service.host.name}">
				    <span class="value">#{service.host.displayName}</span>
				</a>
		    </p>
		    <p>
			    <span class="label">Last checked: </span>
			    <span class="value">#{dateformat('HH:mm:ss', service.state.lastCheckTime)} on #{dateformat('EEEE dd/MM/yyyy', service.state.lastCheckTime)}</span>
		    </p>
		    <p class="output">
			    <span class="label">Output: </span>
			    <span class="value">#{coalesce(service.state.output, '')}</span>
		    </p>
		</div>
	</div>
	
	<div class="row">
		<div class="col4 dash_icon">
			<h3>Statistics</h3>
			<p>
				<span class="label wide">Last runtime: </span>
				<span class="value">#{service.state.lastRuntime} ms</span>
			</p>
			<p>
				<span class="label wide">Average runtime: </span>
				<span class="value">#{service.state.averageRuntime} ms</span>
			</p>
			<p>
				<span class="label wide">Last processing latency: </span>
				<span class="value">#{service.state.lastCheckProcessingLatency} ms</span>
			</p>
			<p>
				<span class="label wide">Average processing latency: </span>
				<span class="value">#{service.state.averageCheckProcessingLatency} ms</span>
			</p>
			<p>
				<span class="label wide">Last execution latency: </span>
				<span class="value">#{service.state.lastCheckExecutionLatency} ms</span>
			</p>
			<p>
				<span class="label wide">Average execution latency: </span>
				<span class="value">#{service.state.averageCheckExecutionLatency} ms</span>
			</p>
		</div>
		<div class="col4 dash_icon">
			<h3>Command</h3>
			<p>
				<span class="label wide">Command Engine: </span>
				<span class="value">#{service.checkCommand.command.engine}</span>
			</p>
			<p>
				<span class="label wide">Command Name: </span>
				<span class="value">#{service.checkCommand.command.name}</span>
			</p>
			<data-set var="parameter" value="#{service.createExecuteCheck().parameters}">
				<p>
					<span class="label wide">#{parameter.name}: </span>
					<span class="value">#{parameter.value}</span>
				</p>
			</data-set>
		</div>
	</div>
	
</fragment>